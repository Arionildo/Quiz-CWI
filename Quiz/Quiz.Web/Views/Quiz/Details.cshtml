@{
    ViewBag.Title = "Details";

}

<h2>
    Details
</h2>


<h1 class="questao"></h1>
<div class="respostas">
    <p><a class="btn btn1 btn-primary btn-lg"></a></p>
    <p><a class="btn btn2 btn-primary btn-lg"></a></p>
    <p><a class="btn btn3 btn-primary btn-lg"></a></p>
    <p><a class="btn btn4 btn-primary btn-lg"></a></p>
</div>

<span id="timer">15</span>


@section Scripts{
    <script>
        //alert(qtdRestaurantes);

        var questao = $('.questao');
        var sortearOrdemPergunta = {};
        var OrdemRespostas = {};
        var sortearOrdemRespostas = {};
        var questaoCerta = '';
        var questaoRespondida = '';



        $.get('@Url.Action("Perguntas", "Quiz", new { id = @ViewBag.id })')
          .done(function (response) {


              sortearOrdemPergunta = jQuery(response).get().sort(function () {
                  return Math.round(Math.random()) - 0.5
              }).slice(0, 5);
              remover();
          });



        function remover() {
            questaoAtual = sortearOrdemPergunta[0];
            sortearOrdemPergunta.splice(0, 1);
            mostraQuestao(questaoAtual);

        }



        $(function () {
            $('.btn').click(function () {
                questaoRespondida = "#" + $(this).attr('id').replace(" ", "-");
                //console.log('Questao Respondida: ' + questaoRespondida);


                console.log(questaoRespondida + ' - ' + questaoCerta);
                if (questaoRespondida === questaoCerta) {
                    $(questaoRespondida).addClass('btn-success');
                    console.log('Certo - ');
                } else {
                    console.log('Errado - ');

                    $(questaoCerta).addClass('btn-success');

                    $(questaoRespondida).addClass('btn-danger')
                };
                setTimeout(
                  function () {
                      $(".respostas").find(".btn-success").removeClass("btn-success")
                      $(".respostas").find(".btn-danger").removeClass("btn-danger")

                      remover();
                  }, 3000);




            });
        });




        function mostraQuestao(questaoAtual) {

            questao.text(questaoAtual.Questao);
            questaoCerta = '.' + questaoAtual.Resposta;
            console.log(questaoCerta);


            questao.text(questaoAtual.Questao);

            questaoCerta = '#' + questaoAtual.Resposta.replace(" ", "-");
            //console.log('Respora certa: ' + questaoAtual.Resposta);

            ordemRespostas = [questaoAtual.Resposta, questaoAtual.erradoA, questaoAtual.erradoB, questaoAtual.erradoC];



            sortearOrdemRespostas = jQuery(ordemRespostas).get().sort(function () {
                return Math.round(Math.random()) - 0.5
            }).slice(0, 5);

            $('.btn1  ').text(sortearOrdemRespostas[0]).attr('id', sortearOrdemRespostas[0].replace(" ", "-"));
            $('.btn2  ').text(sortearOrdemRespostas[1]).attr('id', sortearOrdemRespostas[1].replace(" ", "-"));
            $('.btn3  ').text(sortearOrdemRespostas[2]).attr('id', sortearOrdemRespostas[2].replace(" ", "-"));
            $('.btn4  ').text(sortearOrdemRespostas[3]).attr('id', sortearOrdemRespostas[3].replace(" ", "-"));




            //resposta();
        };


        //Contador regressivo

        window.onload = function () {
            var sec = 15;
            setInterval(function () {

                document.getElementById("timer").innerHTML = sec;
                sec--;
                if (sec == 00) {
                    sec = 15;
                }
            }, 1000);
        }

    </script>
}
